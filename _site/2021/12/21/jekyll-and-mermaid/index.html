<!doctype html>
<html lang="en">

  <head>

  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <link rel="stylesheet" href="/assets/css/main.css">

  <title>Technology</title>

</head>


  <body id="jekyll and mermaid">

    
<header>
  <div class="container-fluid">

    <nav class="navbar navbar-expand-lg navbar-light">

  <h1 class="navbar-brand">Technology</h1>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">

    <span class="navbar-toggler-icon"></span>

  </button>

  <div class="collapse navbar-collapse justify-content-end" id="navbarNav">

    <ul class="navbar-nav">

      
        <li class="nav-item">
          <a class="nav-link" href="/">Posts</a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="/readme/">About</a>
        </li>
      

    </ul>
  </div>
</nav>


  </div><!-- End of container-fluid-->
</header>


    <main>

      <div class="container-fluid">
  <div id="post">

    <h2>Jekyll And Mermaid</h2>

    <p>
      Category:
      
        <a class="category" href="/categories/jekyll">Jekyll</a>
      
    </p>

    <p>Using Mermaid to create graphs for use in your Jekyll project.</p>

<!--more-->

<p>Over many years I have been working on my family history. I’m presently creating a website, which will bring together a collection of biographies detailing what I have learnt about the lives of my forebears.</p>

<p>To make it easier for the reader to understand the connection between those forebears and the present generation, I wanted to create family trees illustrating the links. What I needed was a programme that would allow me to easily create a graph or flow diagram; in my quest to find something suitable, I discovered <a href="https://mermaid-js.github.io/mermaid/#/" target="_blank">Mermaid</a>.</p>

<h3 id="setting-up">Setting Up</h3>
<p>I was able to generate graphs using the following technique;</p>

<p>Add the following to <code class="language-plaintext highlighter-rouge">_layouts/default.html</code>, at a point just before the <code class="language-plaintext highlighter-rouge">&lt;/body&gt;</code> tag.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s">"https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="n">mermaid</span><span class="o">.</span><span class="na">initialize</span><span class="o">({</span> <span class="nl">startOnLoad:</span> <span class="kc">true</span> <span class="o">});&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>Add <code class="language-plaintext highlighter-rouge">jekyll-mermaid</code> to the plugins section of <code class="language-plaintext highlighter-rouge">_config.yml</code></p>

<p>Add <code class="language-plaintext highlighter-rouge">gem "jekyll-mermaid"</code> to the <code class="language-plaintext highlighter-rouge">gemfile</code>.</p>

<p>Run <code class="language-plaintext highlighter-rouge">bundle exec jekyll serve --livereload</code> and rebuild the project.</p>

<p>With everything in place, open a new markdown file, enter the following;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div class="mermaid"&gt;
graph TD
  A --&gt; B;
  A --&gt; C;
  A --&gt; D;
&lt;/div&gt;
</code></pre></div></div>

<p>Having saved the document, and once the project has finished rebuilding, you will have a graph that looks something like this;</p>

<div id="images">
  <div class="row g-1">

    

      <div class="col-12 image-block">

        <img src="/assets/graphics/2021-12-21-mermaid1.png" class="img-fluid img-thumbnail" alt="Mermaid Graphic" />

        <div class="caption">
          <p>Mermaid Graphic</p>
        </div>

      </div><!--End of col-*-->

    

  </div><!--End of row-->
</div>
<!--End of #images-->

<p>Impressive. A <em>family tree</em> layout any genealogist would find useful!</p>

<p>However, the tree is generated when the page is called, which to my mind does rather defeat the point of a static web site. If you would rather create an image of the graph before it is uploaded to the server, and if you are using the Atom Editor, here is an alternative you can try.</p>

<h3 id="the-alternative">The Alternative</h3>
<p>We do not need to add the javascript to the body, or to add the reference to <code class="language-plaintext highlighter-rouge">jekyll-mermaid</code> in <code class="language-plaintext highlighter-rouge">_config.yml</code> or the <code class="language-plaintext highlighter-rouge">gemfile</code>.</p>

<p>Instead, in the Atom Editor, go to [Edit &gt; Preferences &gt; Install ]. Search for <code class="language-plaintext highlighter-rouge">atom-mermaid</code>, and install it.</p>

<p>Create a new file, and add just the code needed to generate the graph</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graph TD
  A --&gt; B;
  A --&gt; C;
  A --&gt; D;
</code></pre></div></div>

<p>Right click on the code, and from the fly out panel, click on <code class="language-plaintext highlighter-rouge">mermaid preview</code>. Run the mouse over to the preview produced and again right click, and this time either <code class="language-plaintext highlighter-rouge">Save as PNG</code> or <code class="language-plaintext highlighter-rouge">Save as SVG</code>.</p>

<div id="images">
  <div class="row g-1">

    

      <div class="col-12 image-block">

        <img src="/assets/graphics/2021-12-21-mermaid2.png" class="img-fluid img-thumbnail" alt="Flyout Panel" />

        <div class="caption">
          <p>Flyout Panel</p>
        </div>

      </div><!--End of col-*-->

    

  </div><!--End of row-->
</div>
<!--End of #images-->

<p>You will be asked where to save the image (in my case they go into <code class="language-plaintext highlighter-rouge">/assets/media/graphics</code>). The image is now ready to be used.</p>

<h3 id="layout">Layout</h3>
<p>I have created a template, <code class="language-plaintext highlighter-rouge">_layouts/biography.html</code>, which as you might expect is the layout I use when creating a new biography page. Within it I have added;</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if page.tree == true %}
  <span class="nt">&lt;h3&gt;</span>Relationships<span class="nt">&lt;/h3&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"tree thumbnail"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/assets/media/trees/{{ page.title | replace: ' ', '-' | downcase }}.png"</span> <span class="na">class=</span><span class="s">"img-fluid"</span> <span class="na">alt=</span><span class="s">"{{ page.title }}"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>

{% endif %}
</code></pre></div></div>

<p>Provided the frontmatter for the biography I am writing includes the line <code class="language-plaintext highlighter-rouge">tree: true</code>, then the requisite tree will be dropped into the newly created page. This will work as long as the title of the biography page matches the filename for the associated graphic. So for example, I have created a biography page describing my grandfathers life. The front matter appears as follows;</p>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
layout: biography
title: My Grandfather

categories: biographies
tags: [associated, surnames]

tree: true
---
</code></pre></div></div>

<p>Note the title; the graphic, showing my grandfather’s family tree, needs to be saved as <code class="language-plaintext highlighter-rouge">/assets/media/trees/my-grandfather.png</code></p>

<p>Once the biography page has been saved and the project rebuilt, you should find the graphic displayed in all its glory!</p>


    <p class="published">
      21 December 2021
    </p>

  </div><!--End of #post-->

</div><!-- End of container-fluid-->


    </main>

    <footer>
  <div class="container-fluid">

    <small>

      <p class="social-media">

  <!--
  Links to social media sites. Make changes to the list at _data/social.yml
  -->
  Social Media: 

     | <a href="https://durnbergerphotography.com" target="_blank">Portfolio</a>

  

     | <a href="https://www.behance.net/durnberger" target="_blank">Behance</a> | 

  

    <a href="https://twitter.com/paul_durnberger" target="_blank">Twitter</a> | 

  

</p><!--End of social-media-->


      <p>This site was built with <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://getbootstrap.com/" target="_blank">Bootstrap</a></p>

      <p>Copyright ©Paul Dürnberger</p>

    </small>

  <nav class="navbar navbar-expand navbar-light">

  <div class="navbar-nav ">


  </div>

</nav>


  </div>
</footer>


    <!--Required by Bootstrap-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  </body>

</html>
